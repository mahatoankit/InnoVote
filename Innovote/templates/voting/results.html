{% extends 'base.html' %} {% load static %} {% block title %}Voting Results -
InnoVote{% endblock %} {% block content %}
<!-- Results Section -->
<section class="py-5">
  <div class="container">
    <div class="row mb-5">
      <div class="col-12">
        <div class="text-center">
          <h1 class="mb-3">
            <i class="fas fa-trophy me-3 text-warning"></i>Voting Results
          </h1>
          <p class="lead text-muted">
            Total votes cast:
            <strong class="text-primary">{{ total_votes }}</strong>
          </p>
        </div>
      </div>
    </div>

    <div class="row">
      {% for project in projects %}
      <div class="col-lg-6 mb-4">
        <div class="results-card">
          <div class="row align-items-center">
            <!-- Project Image -->
            <div class="col-md-4">
              {% if project.image %}
              <img
                src="{{ project.image.url }}"
                class="img-fluid rounded"
                alt="{{ project.title }}"
                style="height: 120px; width: 100%; object-fit: cover"
              />
              {% else %}
              <div
                class="bg-light rounded d-flex align-items-center justify-content-center"
                style="height: 120px"
              >
                <i class="fas fa-project-diagram fa-2x text-muted"></i>
              </div>
              {% endif %}
            </div>

            <!-- Project Info -->
            <div class="col-md-8">
              <div
                class="d-flex justify-content-between align-items-start mb-2"
              >
                <div>
                  <h5 class="mb-1">{{ project.title }}</h5>
                  <span class="category-badge"
                    >{{ project.get_category_display }}</span
                  >
                </div>
                <div class="text-end">
                  {% if forloop.counter == 1 %}
                  <i class="fas fa-crown fa-2x text-warning"></i>
                  {% elif forloop.counter == 2 %}
                  <i class="fas fa-medal fa-2x" style="color: #c0c0c0"></i>
                  {% elif forloop.counter == 3 %}
                  <i class="fas fa-medal fa-2x" style="color: #cd7f32"></i>
                  {% endif %}
                </div>
              </div>

              <!-- Vote Count -->
              <div class="mb-2">
                <span class="vote-count">{{ project.vote_count }}</span>
                <span class="text-muted"
                  >vote{{ project.vote_count|pluralize }}</span
                >
              </div>

              <!-- Progress Bar -->
              <div class="progress mb-2" style="height: 10px">
                {% widthratio project.vote_count total_votes 100 as percentage
                %}
                <div
                  class="progress-bar"
                  role="progressbar"
                  style="width: {% if total_votes > 0 %}{{ percentage }}%{% else %}0%{% endif %}"
                ></div>
              </div>

              <!-- Percentage -->
              <div class="d-flex justify-content-between align-items-center">
                <small class="text-muted">
                  {% if total_votes > 0 %} {{ percentage }}% of total votes {%
                  else %} 0% of total votes {% endif %}
                </small>
                <a
                  href="{% url 'voting:project_detail' project.id %}"
                  class="btn btn-sm btn-outline-primary"
                >
                  <i class="fas fa-eye me-1"></i>View Details
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
      {% empty %}
      <div class="col-12">
        <div class="text-center py-5">
          <i class="fas fa-chart-bar fa-4x text-muted mb-3"></i>
          <h3 class="text-muted">No Projects Yet</h3>
          <p class="text-muted">
            Results will be displayed here once projects are added and voting
            begins.
          </p>
        </div>
      </div>
      {% endfor %}
    </div>

    <!-- Statistics Card -->
    {% if projects %}
    <div class="row mt-5">
      <div class="col-12">
        <div class="card border-primary">
          <div class="card-header bg-primary text-white">
            <h5 class="mb-0">
              <i class="fas fa-chart-line me-2"></i>Voting Statistics
            </h5>
          </div>
          <div class="card-body">
            <div class="row text-center">
              <div class="col-md-3 mb-3">
                <h4 class="text-primary">{{ projects.count }}</h4>
                <p class="text-muted mb-0">Total Projects</p>
              </div>
              <div class="col-md-3 mb-3">
                <h4 class="text-success">{{ total_votes }}</h4>
                <p class="text-muted mb-0">Total Votes</p>
              </div>
              <div class="col-md-3 mb-3">
                {% with projects.first as winner %}
                <h4 class="text-warning">
                  {% if winner %}{{ winner.vote_count }}{% else %}0{% endif %}
                </h4>
                <p class="text-muted mb-0">Highest Votes</p>
                {% endwith %}
              </div>
              <div class="col-md-3 mb-3">
                <h4 class="text-info">
                  {% if total_votes > 0 and projects.count > 0 %} {{
                  total_votes|floatformat:0 }} {% else %} 0 {% endif %}
                </h4>
                <p class="text-muted mb-0">Avg Votes per Project</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    {% endif %}

    <!-- Top 3 Podium (if we have results) -->
    {% if projects and total_votes > 0 %}
    <div class="row mt-5">
      <div class="col-12">
        <h3 class="text-center mb-4">
          <i class="fas fa-podium me-2"></i>Top 3 Projects
        </h3>
        <div class="row justify-content-center">
          {% for project in projects|slice:":3" %}
          <div class="col-md-4 mb-3">
            <div class="card border-0 shadow text-center">
              <div class="card-body">
                {% if forloop.counter == 1 %}
                <div class="mb-3">
                  <i class="fas fa-crown fa-3x text-warning"></i>
                  <h5 class="text-warning mt-2">1st Place</h5>
                </div>
                {% elif forloop.counter == 2 %}
                <div class="mb-3">
                  <i class="fas fa-medal fa-3x" style="color: #c0c0c0"></i>
                  <h5 class="mt-2" style="color: #c0c0c0">2nd Place</h5>
                </div>
                {% elif forloop.counter == 3 %}
                <div class="mb-3">
                  <i class="fas fa-medal fa-3x" style="color: #cd7f32"></i>
                  <h5 class="mt-2" style="color: #cd7f32">3rd Place</h5>
                </div>
                {% endif %}

                <h6 class="card-title">{{ project.title }}</h6>
                <p class="text-muted">
                  {{ project.vote_count }} vote{{ project.vote_count|pluralize
                  }}
                </p>
                <span class="category-badge"
                  >{{ project.get_category_display }}</span
                >
              </div>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
    </div>
    {% endif %}

    <!-- Action Buttons -->
    <div class="row mt-5">
      <div class="col-12 text-center">
        <a href="{% url 'voting:home' %}" class="btn btn-primary btn-lg me-3">
          <i class="fas fa-arrow-left me-2"></i>Back to Projects
        </a>
        <button
          onclick="window.print()"
          class="btn btn-outline-secondary btn-lg"
        >
          <i class="fas fa-print me-2"></i>Print Results
        </button>
      </div>
    </div>
  </div>
</section>
{% endblock %} {% block extra_css %}
<style>
  @media print {
    .navbar,
    .btn,
    footer {
      display: none !important;
    }

    .results-card {
      page-break-inside: avoid;
      margin-bottom: 1rem;
    }

    .progress-bar {
      background-color: #000 !important;
    }
  }
</style>
{% endblock %}
